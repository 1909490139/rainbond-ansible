#!/bin/bash

version=5.0
rainbond=(rbd-worker rbd-chaos rbd-api rbd-app-ui rbd-webcli rbd-mq rbd-monitor rbd-gateway rbd-eventlog rbd-dns)

upgrade(){
    if [ "$1" == "all" ];then
        echo "will upgrade all image"
        for img in ${rainbond[@]}
        do
            docker pull rainbond/${img}:${version}
            docker tag rainbond/${img}:${version} goodrain.me/${img}:${version}
            docker push goodrain.me/${img}:${version}
        done
    else
        echo "will upgrade $1 image"
        for img in ${rainbond[@]}
        do
            if [ "$1" == "$img" ];then
                docker pull rainbond/${img}:${version}
                docker tag rainbond/${img}:${version} goodrain.me/${img}:${version}
                docker push goodrain.me/${img}:${version}
            fi
        done
    fi
}

case $1 in
    upgrade)
        upgrade $2 
    ;;
    *)
        echo "not support cmd $1"
    ;;
esac